<!DOCTYPE html>
<html>
  <head>
   <script src="jquery.js"></script>
   <script src="data_generator.js"></script>
   <link href="twittler.css" rel="stylesheet" type="text/css"/>
   <link href="https://fonts.googleapis.com/css?family=Merriweather" rel="stylesheet" type="text/css">
   <link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet" type="text/css">
   <link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300" rel="stylesheet" type="text/css">
  </head>
  <body>
   <header>
    <h1>Twittler</h1>
  </header>
  <section>
   <img src="https://www.google.com/url?sa=i&rct=j&q=&esrc=s&source=images&cd=&ved=0ahUKEwi9xJvlrarXAhUR8mMKHcZeA9YQjhwIBQ&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FFile%3ATwitter_bird_logo_2012.svg&psig=AOvVaw1zaagojHsYrYD7_WYRepJn&ust=1510071752833317" alt="Twitter Bird">
   <span>Home</span>
   </section>
   <section class="row">
     <h2>New Tweets</h2>
  </section>

  <div><input id="user_writes"><button>Post new tweets</button></div>
  <div id="tweets"></div>
  <div id="individual_person_tweets"></div>
  <button id="newTweets">See new tweets</button>

    <script>
     var totalTweets = 0;
     var counter = 0;
     var display = 0;

      $(document).ready(function(){
        var $body = $('#tweets');
        $body.html('');

        var index = streams.home.length - 1;
        
        while(index >= 0){
          var tweet = streams.home[index];
          var $tweet = $('<div></div>');
          var date = tweet.created_at;
          $tweet.html('@' + "<span class='tweet_user'>" + tweet.user + "</span>" + ': ' + tweet.message + ' ' + date);
          $tweet.prependTo($('#tweets')); // make prepend so new tweets show up at top?
          totalTweets++;
          index -= 1;
        }

        // alert message when new tweet button is clicked

        $('#newTweets').on('click', function() {
          alert('New tweets are on the way!');
        });

        $('#newTweets').on('click', showNewTweets); // generate new tweets when user clicks button

      // need a way to store tweets as they are generated
      
      function checkForTweets() {
        counter = streams.home.length - 1;
        display = counter - totalTweets;
        setTimeout(checkForTweets, 1500);
      }
      checkForTweets();
    
    // see user's tweets when clicked
    $('.tweet_user').on('click', function() {
      var userName = $(this).text();
      var name = streams.users[userName];
      for (var i = 0; i < name.length; i++) {
        var $tweet = $('<div></div>');
        $tweet.html('@' + "<span class='tweet_user'>" + userName + "</span>" + ': ' + name[i].message + ' ' + date);
        $('#tweets').slideUp();
        $('#individual_person_tweets').slideDown();
        $tweet.prependTo($('#individual_person_tweets'));
        totalTweets++;
        display -= 1;
      }
    });


     // new tweet added to list in the input button
     $('#user_writes').on('input', function() {
       var $tweet = ('<div></div>');
       $tweet.html('@' + "span class='tweet_user'>guest</span>" + ': ' + ':text' + new Date());
       $tweet.prependTo($('#tweets'));
       totalTweets++;
       display -= 1;
     });
 
    });
  
  // need to display new tweets when button is pressed, not only after document is ready
   function showNewTweets() {
     while (display >= 1) {
      var tweet = streams.home[display];
      var $tweet = $('<div></div>');
      $tweet.html('@' + "<span class='tweet_user'>" + tweet.user + "</span>" + ': ' + tweet.message + ' ' + new Date());
      $tweet.prependTo($('#tweets'));
      totalTweets++;
      display -= 1;
     }
   }

   // problems: date appears the same even after pressing the button
   // other problem: the tweet list keeps getting longer (need to delete old tweets)

    </script>
  </body>
</html>
